<!DOCTYPE html>
<html lang="en-US">
<html>
  <head>
    <title>FizzBuzz</title>
    <link href="fizzbuzz.css" rel="stylesheet" type-"text/css" />
  </head>
  <body onload = "display()">
    <h1> Welcome, <span id="username">username</span> </h1>
      <p> Your current FizzBuzz value is: <span id="fizzBuzzValue">0</span> </p>
    <div class="center">
      <button type="button" class="button" onclick="displayScore()" onload="display()">Click to increment</button>
    </div>
    <script src="main.js"></script>
    <script>
      newScore = document.getElementById("fizzBuzzValue").innerHTML;
      function display() {
        get("http://basic-web.dev.avc.web.usf.edu/" + "try").then(function(response) {
          if(response.status == 200){
            const username = response.data.id; //The username that was requested. In this case it is "myUserName".
            const score = response.data.score; //The user's current score.
            document.getElementById("username").innerHTML = username;
            document.getElementById("fizzBuzzValue").innerHTML = score;
            newScore = score - 1
            displayScore();
            newScore = score;
          }
          else{
            //User "myUserName" not found.
            //response.data is null
            post("http://basic-web.dev.avc.web.usf.edu/" + "try", { score: 0 }); //create a new user.
          }
        });
      }
      function displayScore() {
          newScore++;
          if((newScore % 3 == 0) && (newScore % 5 == 0)) {
            document.getElementById("fizzBuzzValue").innerHTML = "FizzBuzz";
          } else if (newScore % 3 == 0) {
            document.getElementById("fizzBuzzValue").innerHTML = "Fizz";
          } else if (newScore % 5 == 0) {
            document.getElementById("fizzBuzzValue").innerHTML = "Buzz";
          } else {
            document.getElementById("fizzBuzzValue").innerHTML = newScore;
          }
          sendScore();
      }

      function sendScore() {
        const dataToSend = { score: newScore };
        post("http://basic-web.dev.avc.web.usf.edu/" + "try", dataToSend).then(function(response){
          switch(response.status){
            case 200:
              //User was updated successfully.
              //response.data will be the same as returned by get(), and should contain the updated data.
              const updatedScore = response.data.score;
              break;
            case 201:
              //A new user was successfully created. Otherwise same as status 200.
              const newScore = response.data.score;
              break;
            case 400:
              //Bad request. Most likely your data that you sent (in this case dataToSend) was formatted incorrectly, or you supplied a negative score value.
              //response.data will be: { Error: "error message" }
              console.error(response.data);
              break;
            case 500:
              //Something went wrong on the server, such as the database got deleted somehow. This should never happen.
              //response.data will be the same as status 400.
              console.error(response.data);
              break;
          }
        });
      }
    </script>
  </body>
</html>
